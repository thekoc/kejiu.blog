---
title: 'Systemd ä½¿ç”¨ä¸å®Œå…¨æŒ‡åŒ—'
date: '2023-08-30'
tags: ['systemd', 'devops', 'linux']
summary: 'ä¸å®Œå…¨ã€ä¸å®˜æ–¹ã€ä¸å…¨é¢çš„ Systemd ä½¿ç”¨æŒ‡åŒ— ğŸ§­'
images: []
authors: ['default']
---

## å‰è¨€

ä¹‹å‰çš„[ä¸€ç¯‡æ–‡ç« ](/blog/launchd-explained)ä»‹ç»äº†ä¸€ä¸‹ macOS çš„ `launchd`ï¼Œè¿™æ¬¡å°±æ¥ä»‹ç»ä¸€ä¸‹ Linux ä¸Šçš„ counterpartï¼š`systemd`ã€‚

å‡ å¹´å‰ï¼Œ`systemd` å‡ºç°çš„æ—¶å€™è¿˜å¼•èµ·äº†å¾ˆå¤§çš„äº‰è®®ï¼Œå¤§å®¶çš„ç†ç”±æ— éæ˜¯â€œè¿å Unix å“²å­¦â€ï¼Œâ€œé‚ªæ¶çš„çº¢å¸½æ­£åœ¨ä¾µèš€ Linuxâ€ï¼Œâ€œsystemd æƒ³è¦æ¥ç®¡ä¸€åˆ‡â€ç­‰ç­‰ã€‚ä½†æ˜¯ï¼Œå‡ å¹´åçš„ä»Šå¤©ï¼Œä¸»æµ Linux å‘è¡Œç‰ˆçš„é»˜è®¤ init ç³»ç»Ÿéƒ½å·²ç»å˜æˆ `systemd`ï¼ˆä»¥ä¸‹è¡¨æ ¼èŠ‚é€‰è‡ª[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Systemd)ï¼‰ã€‚åªèƒ½è¯´çœŸé¦™å®šå¾‹æ°¸ä¸è¿‡æ—¶â€¦â€¦


|Linux distribution|Enabled by default?|Date released as default|
|---|---|---|
|[Android](https://en.wikipedia.org/wiki/Android_(operating_system) "Android (operating system)")|No|â€”|
|[Arch Linux](https://en.wikipedia.org/wiki/Arch_Linux "Arch Linux")|Yes|October 2012[[71]](https://en.wikipedia.org/wiki/Systemd#cite_note-arch-systemd-72)|
|[CentOS](https://en.wikipedia.org/wiki/CentOS "CentOS")|Yes|July 2014Â (v7.0)|
|[Debian](https://en.wikipedia.org/wiki/Debian "Debian")|Yes|April 2015Â (v8.0)[[75]](https://en.wikipedia.org/wiki/Systemd#cite_note-ctte-20140211-76)|
|[Fedora Linux](https://en.wikipedia.org/wiki/Fedora_Linux "Fedora Linux")|Yes|May 2011Â (v15)|
|[Gentoo Linux](https://en.wikipedia.org/wiki/Gentoo_Linux "Gentoo Linux")[[b]](https://en.wikipedia.org/wiki/Systemd#cite_note-81)|No|â€”|
|[Linux Mint](https://en.wikipedia.org/wiki/Linux_Mint "Linux Mint")|Yes|August 2018(LMDE 3)|
|[Manjaro Linux](https://en.wikipedia.org/wiki/Manjaro_Linux "Manjaro Linux")|Yes|November 2013|
|[openSUSE](https://en.wikipedia.org/wiki/OpenSUSE "OpenSUSE")|Yes|September 2012(v12.2)[[89]](https://en.wikipedia.org/wiki/Systemd#cite_note-AutoWR-1-91)|
|[Red Hat Enterprise Linux](https://en.wikipedia.org/wiki/Red_Hat_Enterprise_Linux "Red Hat Enterprise Linux")|Yes|June 2014(v7.0)|
|[SUSE Linux Enterprise Server](https://en.wikipedia.org/wiki/SUSE_Linux_Enterprise_Server "SUSE Linux Enterprise Server")|Yes|October 2014(v12)|
|[Ubuntu](https://en.wikipedia.org/wiki/Ubuntu_(operating_system) "Ubuntu (operating system)")|Yes|April 2015(v15.04)|

## é…ç½®æ–‡ä»¶è·¯å¾„

å’Œ `launchd` ä¸€æ ·ï¼Œ`systemd` çš„é…ç½®æ–‡ä»¶ä¹Ÿå¯ä»¥æ”¾åœ¨ä¸åŒçš„è·¯å¾„ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœè¦æ–°å»ºç³»ç»Ÿçº§åˆ«çš„åå°ä»»åŠ¡ï¼Œé‚£ä¹ˆé…ç½®æ–‡ä»¶åº”è¯¥æ”¾åœ¨ `/etc/systemd/system` ä¸‹ï¼Œå¦‚æœæ˜¯ç”¨æˆ·çº§åˆ«çš„åå°ä»»åŠ¡ï¼Œé‚£ä¹ˆé…ç½®æ–‡ä»¶åº”è¯¥æ”¾åœ¨ `~/.config/systemd/user` ä¸‹ã€‚é™¤äº†è¿™ä¸¤ä¸ªä½ç½®è¿˜å­˜åœ¨å¾ˆå¤šå…¶ä»–ä½ç½®ï¼Œå¦‚æœä½ æƒ³äº†è§£çš„è¯ï¼Œä¸‹é¢å¼•ç”¨äº† `systemd.unit(5)` æ“ä½œæ‰‹å†Œçš„è¡¨æ ¼ï¼š


```
       Table 1.  Load path when running in system mode (--system).
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚Path                          â”‚ Description              â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/etc/systemd/system.control   â”‚ Persistent and transient â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ configuration created    â”‚
       â”‚/run/systemd/system.control   â”‚ using the dbus API       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/transient        â”‚ Dynamic configuration    â”‚
       â”‚                              â”‚ for transient units      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/generator.early  â”‚ Generated units with     â”‚
       â”‚                              â”‚ high priority (see       â”‚
       â”‚                              â”‚ early-dir in             â”‚
       â”‚                              â”‚ systemd.generator(7))    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/etc/systemd/system           â”‚ System units created by  â”‚
       â”‚                              â”‚ the administrator        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/system           â”‚ Runtime units            â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/generator        â”‚ Generated units with     â”‚
       â”‚                              â”‚ medium priority (see     â”‚
       â”‚                              â”‚ normal-dir in            â”‚
       â”‚                              â”‚ systemd.generator(7))    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/usr/local/lib/systemd/system â”‚ System units installed   â”‚
       â”‚                              â”‚ by the administrator     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/usr/lib/systemd/system       â”‚ System units installed   â”‚
       â”‚                              â”‚ by the distribution      â”‚
       â”‚                              â”‚ package manager          â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/generator.late   â”‚ Generated units with low â”‚
       â”‚                              â”‚ priority (see late-dir   â”‚
       â”‚                              â”‚ in systemd.generator(7)) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

       Table 2.  Load path when running in user mode (--user).
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚Path                                     â”‚ Description              â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_CONFIG_HOME/systemd/user.control    â”‚ Persistent and transient â”‚
       â”‚or                                       â”‚ configuration created    â”‚
       â”‚~/.config/systemd/user.control           â”‚ using the dbus API       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ($XDG_CONFIG_HOME is     â”‚
       â”‚$XDG_RUNTIME_DIR/systemd/user.control    â”‚ used if set, ~/.config   â”‚
       â”‚                                         â”‚ otherwise)               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_RUNTIME_DIR/systemd/transient       â”‚ Dynamic configuration    â”‚
       â”‚                                         â”‚ for transient units      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_RUNTIME_DIR/systemd/generator.early â”‚ Generated units with     â”‚
       â”‚                                         â”‚ high priority (see       â”‚
       â”‚                                         â”‚ early-dir in             â”‚
       â”‚                                         â”‚ systemd.generator(7))    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_CONFIG_HOME/systemd/user or         â”‚ User configuration       â”‚
       â”‚$HOME/.config/systemd/user               â”‚ ($XDG_CONFIG_HOME is     â”‚
       â”‚                                         â”‚ used if set, ~/.config   â”‚
       â”‚                                         â”‚ otherwise)               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_CONFIG_DIRS/systemd/user or         â”‚ Additional configuration â”‚
       â”‚/etc/xdg/systemd/user                    â”‚ directories as specified â”‚
       â”‚                                         â”‚ by the XDG base          â”‚
       â”‚                                         â”‚ directory specification  â”‚
       â”‚                                         â”‚ ($XDG_CONFIG_DIRS is     â”‚
       â”‚                                         â”‚ used if set, /etc/xdg    â”‚
       â”‚                                         â”‚ otherwise)               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/etc/systemd/user                        â”‚ User units created by    â”‚
       â”‚                                         â”‚ the administrator        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_RUNTIME_DIR/systemd/user            â”‚ Runtime units (only used â”‚
       â”‚                                         â”‚ when $XDG_RUNTIME_DIR is â”‚
       â”‚                                         â”‚ set)                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/run/systemd/user                        â”‚ Runtime units            â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_RUNTIME_DIR/systemd/generator       â”‚ Generated units with     â”‚
       â”‚                                         â”‚ medium priority (see     â”‚
       â”‚                                         â”‚ normal-dir in            â”‚
       â”‚                                         â”‚ systemd.generator(7))    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_DATA_HOME/systemd/user or           â”‚ Units of packages that   â”‚
       â”‚$HOME/.local/share/systemd/user          â”‚ have been installed in   â”‚
       â”‚                                         â”‚ the home directory       â”‚
       â”‚                                         â”‚ ($XDG_DATA_HOME is used  â”‚
       â”‚                                         â”‚ if set, ~/.local/share   â”‚
       â”‚                                         â”‚ otherwise)               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_DATA_DIRS/systemd/user or           â”‚ Additional data          â”‚
       â”‚/usr/local/share/systemd/user and        â”‚ directories as specified â”‚
       â”‚/usr/share/systemd/user                  â”‚ by the XDG base          â”‚
       â”‚                                         â”‚ directory specification  â”‚
       â”‚                                         â”‚ ($XDG_DATA_DIRS is used  â”‚
       â”‚                                         â”‚ if set, /usr/local/share â”‚
       â”‚                                         â”‚ and /usr/share           â”‚
       â”‚                                         â”‚ otherwise)               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$dir/systemd/user for each $dir in       â”‚ Additional locations for â”‚
       â”‚$XDG_DATA_DIRS                           â”‚ installed user units,    â”‚
       â”‚                                         â”‚ one for each entry in    â”‚
       â”‚                                         â”‚ $XDG_DATA_DIRS           â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/usr/local/lib/systemd/user              â”‚ User units installed by  â”‚
       â”‚                                         â”‚ the administrator        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚/usr/lib/systemd/user                    â”‚ User units installed by  â”‚
       â”‚                                         â”‚ the distribution package â”‚
       â”‚                                         â”‚ manager                  â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚$XDG_RUNTIME_DIR/systemd/generator.late  â”‚ Generated units with low â”‚
       â”‚                                         â”‚ priority (see late-dir   â”‚
       â”‚                                         â”‚ in systemd.generator(7)) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é…ç½®æ–‡ä»¶æ ¼å¼

åœ¨ `systemd` ä¸­ï¼Œä¸€ä¸ª `unit` ä»£è¡¨å…¶ç®¡ç†çš„å’Œæ“ä½œçš„å•å…ƒï¼Œä¾‹å¦‚ä¸€ä¸ªåå°æœåŠ¡ã€ä¸€ä¸ªæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ã€ä¸€ä¸ªç½‘ç»œæ¥å£ç­‰ç­‰ã€‚æ¯ä¸ª `unit` éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œ`systemd` æ ¹æ®é…ç½®æ–‡ä»¶çš„åç¼€åå†³å®š `unit` çš„ç±»å‹ã€‚æœ€å¸¸ç”¨çš„ `unit` ç±»å‹æ˜¯ `service`ï¼Œä»£è¡¨äº†è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„åå°æœåŠ¡å’Œåº”ç”¨ã€‚å…¶ä»–çš„ç±»å‹åŒ…æ‹¬ `socket`, `device`, `mount` ç­‰ç­‰ï¼Œè¯¦ç»†çš„è¯´æ˜å¯ä»¥åœ¨å¯¹åº”çš„æ“ä½œæ‰‹å†Œä¸­æŸ¥çœ‹ï¼Œä¾‹å¦‚ `man systemd.socket`ã€‚

ä¸€ä¸ªç®€å•çš„ `service` ç±»å‹é…ç½®æ–‡ä»¶æ˜¯è¿™ä¸ªæ ·å­ï¼š

```ini
[Unit]
Description=My Service

[Service]
ExecStart=/usr/local/bin/my-service


[Install]
WantedBy=multi-user.target
```

å¦‚æœæŠŠè¿™ä¸ªé…ç½®æ–‡ä»¶å‘½åä¸º `myservice.service`ï¼Œé‚£ä¹ˆ `systemctl enable myservice.service` å°±ä¼šåˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥åˆ° `/etc/systemd/system/multi-user.target.wants/myservice.service`ï¼Œè¿™æ ·å½“ç³»ç»Ÿå¯åŠ¨åˆ° `multi-user.target` çš„æ—¶å€™ï¼Œ`systemd` å°±ä¼šè‡ªåŠ¨åŠ è½½ `myservice.service`ã€‚

è¿™é‡Œæåˆ°äº†ä¸€ä¸ª `target` çš„æ¦‚å¿µï¼Œ`target` å¯ä»¥çœ‹ä½œ `unit` çš„ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œ`systemd` ä¼šåœ¨å¯åŠ¨çš„æ—¶å€™æŒ‰ç…§ä¾èµ–å…³ç³»åŠ è½½ `target` å’Œä¸ä¹‹å…³è”çš„ `unit`ã€‚ä½ å¯ä»¥é€šè¿‡ï¼š
```bash
systemctl list-units --type=target
```

æ¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æœ‰å“ªäº› `target`ã€‚å‡ ä¸ªå¸¸ç”¨çš„ `target` æ˜¯ï¼š

- `default.target`: `systemd` é»˜è®¤ä½¿ç”¨è¿™ä¸ª `target` æ¥å¯åŠ¨ç³»ç»Ÿï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´ä¸€èˆ¬æ˜¯ `multi-user.target` çš„åˆ«åï¼Œå¯ä»¥ç”¨ ` systemctl get-default` æŸ¥çœ‹å…·ä½“çš„å€¼ã€‚
- `multi-user.target`ï¼šå¤šç”¨æˆ·ç³»ç»Ÿå¯åŠ¨çš„ `target`ï¼Œä¸€èˆ¬æ˜¯ä¸å¸¦å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨æ¨¡å¼ã€‚
- `graphical.target`ï¼šå›¾å½¢ç•Œé¢çš„å¯åŠ¨ `target`ã€‚
- `reboot.target`ï¼šç³»ç»Ÿé‡å¯ã€‚

è¿™é‡Œåªæ˜¯ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹ `systemd` çš„é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œæ›´è¯¦ç»†çš„è¯´æ˜å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ `man systemd.unit` æ¥æŸ¥çœ‹ã€‚

## å¸¸ç”¨å‘½ä»¤

### åŠ è½½ã€å¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€é‡è½½é…ç½®æ–‡ä»¶

```bash
systemctl enable example.service # é€šè¿‡ç¬¦å·è¿æ¥å°†é…ç½®æ–‡ä»¶åŠ è½½åˆ° [Install] éƒ¨åˆ†æŒ‡å®šçš„ target ä¸­
systemctl disable example.service # ä» [Install] éƒ¨åˆ†æŒ‡å®šçš„ target ä¸­ç§»é™¤é…ç½®æ–‡ä»¶
systemctl start example.service # å¯åŠ¨æœåŠ¡
systemctl stop example.service # åœæ­¢æœåŠ¡
systemctl restart example.service # é‡å¯æœåŠ¡
systemctl reload example.service # é‡è½½é…ç½®æ–‡ä»¶
systemctl mask nginx.service # ç¦æ­¢æœåŠ¡å¯åŠ¨
```

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
systemctl status example.service # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl is-enabled example.service # æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¤„äºå¯ç”¨çŠ¶æ€
systemctl is-active example.service # æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€
systemctl list-units --type=service # æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„çŠ¶æ€
systemctl cat example.service # æŸ¥çœ‹æœåŠ¡çš„é…ç½®æ–‡ä»¶çš„å†…å®¹
systemctl list-dependencies sshd.service # æŸ¥çœ‹æœåŠ¡çš„ä¾èµ–å…³ç³»

```


### æŸ¥çœ‹æ—¥å¿—

`systemd` å¥—ä»¶ä¸­è‡ªå¸¦äº†ä¸€ä¸ªæ—¥å¿—ç®¡ç†ç³»ç»Ÿ `journald`ï¼Œå¯ä»¥é€šè¿‡ `journalctl` å‘½ä»¤æ¥æŸ¥çœ‹æ—¥å¿—ã€‚

```bash
journalctl # æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
journalctl -b # æŸ¥çœ‹å½“å‰ç³»ç»Ÿå¯åŠ¨åäº§ç”Ÿçš„æ—¥å¿—
journalctl -u example.service # æŸ¥çœ‹ example.service çš„æ—¥å¿—
journalctl -u example.service --since today # æŸ¥çœ‹ example.service ä»Šå¤©äº§ç”Ÿçš„æ—¥å¿—
journalctl -u example.service --since "2023-08-30 00:00:00" --until "2023-08-31 00:00:00" # æŸ¥çœ‹ example.service åœ¨ æŒ‡å®šæ—¶é—´å†…
journalctl -f # å®æ—¶æŸ¥çœ‹æ—¥å¿—
journalctl --disk-usage # æŸ¥çœ‹æ—¥å¿—å ç”¨çš„ç£ç›˜ç©ºé—´
journalctl --vacuum-size=1G # åˆ é™¤æ—¥å¿—ï¼Œç›´åˆ°å ç”¨çš„ç©ºé—´å°äº 1G
```


---

## å‚è€ƒèµ„æ–™

1. [Managing systemd targets with systemctl](https://documentation.suse.com/smart/systems-management/html/)reference-managing-systemd-targets-systemctl/index.html)
2. [Systemd å…¥é—¨æ•™ç¨‹ï¼šå‘½ä»¤ç¯‡](https://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)
3. [Understanding Systemd Units and Unit Files](https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files)
4. [systemd.unit(5) â€” Linux manual page](https://man7.org/linux/man-pages/man5/systemd.unit.5.html)
5. [How To Use Systemctl to Manage Systemd Services and Units
](https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units)
6. [How To Use Journalctl to View and Manipulate Systemd Logs](https://www.digitalocean.com/community/tutorials/how-to-use-journalctl-to-view-and-manipulate-systemd-logs)